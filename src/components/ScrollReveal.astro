---
// Scroll reveal animation wrapper
// Animates elements into view as user scrolls
---

<div class="scroll-reveal">
  <slot />
</div>

<style>
  .scroll-reveal {
    opacity: 0;
    transform: translateY(40px);
    transition: all 600ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .scroll-reveal[data-direction="down"] {
    transform: translateY(-40px);
  }

  .scroll-reveal[data-direction="left"] {
    transform: translateX(40px);
  }

  .scroll-reveal[data-direction="right"] {
    transform: translateX(-40px);
  }

  .scroll-reveal[data-direction="fade"] {
    transform: none;
  }

  .scroll-reveal.visible {
    opacity: 1;
    transform: translateY(0) translateX(0);
  }

  @media (prefers-reduced-motion: reduce) {
    .scroll-reveal {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
    }
  }
</style>

<script define:vars={{ delay: Astro.props.delay || 0 }}>
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const el = entry.target;
        const delayValue = parseInt(el.dataset.delay) || 0;

        setTimeout(() => {
          el.classList.add('visible');
        }, delayValue);

        observer.unobserve(el);
      }
    });
  }, {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  });

  document.querySelectorAll('.scroll-reveal').forEach(el => {
    observer.observe(el);
  });
</script>
